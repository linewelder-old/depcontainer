# Контейнер зависимостей

Автоматически разрешает зависимости (Dependency Injection).

## Как использовать

### Компоненты

Классы, объекты которых должен заведовать контейнер, должны быть обозначены аннотацией `@Component`.

Контейнер хранит в себе объекты таких классов - компоненты - один на класс или несколько на класс,
различаемые квалификаторами.

### Взаимодействие с контейнером

Для запроса компонента из контейнера можно использовать метод getComponent, передавая класс и опционально
квалификатор необходимого компонента. Если квалификатора нет, то метод вернёт первый компонент
этого типа.

Для добавления созданного вручную компонента в контейнер можно использовать метод addComponent, передавая
желаемые класс и квалификатор. Если такой компонент уже есть в контейнере, а если квалификатор null, то
проверяется любой компонент такого типа, то метод кидает исключение.

### Конструирование компонентов

Если в контейнере нет запрашиваемого компонента, он конструируется автоматически.

По умолчанию используется первый конструктор, но это можно изменить, добавив к желаемому конструктору
аннотацию `@Autowired`.

Используемый конструктор должен иметь параметры только типов, отмеченных аннотацией `@Component` либо
`String`.

При создании компонента, контейнер находит или рекурсивно создаёт все компоненты для подставления в
параметры конструктора, используя `getComponent`. Для указания квалификатора необходимого компонента
можно  использовать аннотацию `@Qualifier(String)` на параметре.

Параметры типа `String` принимают значение квалификатора создаваемого компонента.

После создания объекта, контейнер вызывает все методы класса, обозначенные аннотацией `@PostConstructor`.

### Цикличные зависимости

При обнаружении цикла в зависимостях при создании компонента кидается исключение, где сам цикл можно
проследить по сообщениям исключений.

Например:
```
Exception in thread "main" java.lang.IllegalArgumentException: Unable to resolve dependencies for class Application.
	...
Caused by: java.lang.IllegalArgumentException: Unable to resolve dependencies for class PenguinFactory.
	...
Caused by: java.lang.IllegalArgumentException: Unable to resolve dependencies for class Logger.
	...
Caused by: java.lang.IllegalArgumentException: Cyclic dependency detected: class Application instance is currently being created.
	...
```

### События

Методы `addPreAddListener` и `addPostAddListener` позволяют подписаться на добавление новых компонентов
в контейнер, получая сообщение сразу перед и сразу после события соответственно.

**Обработчики, добавленные первым методом оповещаются при вызове метода `addComponent` даже если позже
кидается исключение из-за попытки замены существующего компонента.**
